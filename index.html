<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather</title>
    <!--API KEY: 135f15ba9e1e49d3a64160722231710  -->
    <!--API URL: https://www.weatherapi.com/my/ -->


    <link rel="stylesheet" href="style.css">
    <script defer src="script.js"></script> <!--defer makes it execute after body-->

</head>

<body>
    <!--current-card is for current weather-->
    <div class = "current-card">

        <div class="search">
            <input type = "text" placeholder = "enter city name" spellcheck = "false"> <!--Search bar-->
            <button><img src="images2/search.png"></button> <!--search button-->
        </div>

        <div class="weather">
            <img id = "icon" src="images2/clear.png" class = "weather-icon"> <!--Current Weather image-->
            <h2 class="city">Location</h2>   <!--Current Weather location-->
            <p class="region">Region</p> <!--<p class="country">Country</p>-->
            <h1 class="temp">0째C</h1>    <!--Current weather temperature-->
            <h3 class="feel">Feels Like 0째C</h3>    <!--Feels like temperatur-->
            <h3 class="condition">Condition</h3>  <!--Current Condition-->
            <br>

            <!--Details for current weather-->
            <div class="details">
                <!--Column for humidity-->
                <div class="col">
                    <img src="images2/humidity.png">
                    <div>
                        <p class="humidity">0%</p>
                        <p>Humidity</p>
                    </div>
                </div>
                <!--Column for Wind-->
                <div class="col">
                    <img src="images2/wind.png">
                    <div>
                        <p class="wind">0 km/h</p>
                        <p>Wind Speed</p>
                    </div>
                </div>
                
            </div>

            <div class="details">
                <!--Column for sunrise-->
                <div class="col">
                    <img src="images2/sunrise.png">
                    <div>
                        <p class="sunrise">0:00 PM</p>
                        <p>Sunrise</p>
                    </div>
                </div>
                <!--Column for sunset-->
                <div class="col">
                    <img src="images2/sunset.png">
                    <div>
                        <p class="sunset">0:00 AM</p>
                        <p>Sunset</p>
                    </div>
                </div>
            </div>


        </div>

    </div>

    <div class="hourly-card">
        <div class="hourly-weather">
            <h1>Hourly Forecast</h1>
        </div>
    </div>


    

<script>
    const date = new Date();  /*create a data object (need date to fetch sunrise/sunset data from api)*/
    let currentDate = date.toJSON().slice(0, 10);  /*slice only the portion for the data ex: "2023-01-07" */
    /*Date functionality from https://www.freecodecamp.org/news/javascript-get-current-date-todays-date-in-js/*/
   
    const apiURL = "https://api.weatherapi.com/v1/";
    const current = "current.json?"
    const key = "key=135f15ba9e1e49d3a64160722231710&q=";
    const airData = "&agi=yes"
    const astro = "astronomy.json?"
    const astroEnd = "&dt="+currentDate;


    const searchBox = document.querySelector(".search input");
    const searchBtn = document.querySelector(".search button");

    /*const apiRequest = apiURL + current + key + city + end;*/

    async function checkWeather(city){

        /*fetch 3 day weather data*/
        const response = await fetch(apiURL + "forecast.json?"+ key + city + "&days=3&aqi=yes&alerts=yes");
        var data = await response.json();


        console.log(data);

        /*Put current weather data into website*/
        document.getElementById("icon").src= data.current.condition.icon;
        document.querySelector(".city").innerHTML = data.location.name;
        document.querySelector(".region").innerHTML = data.location.region +" "+data.location.country;
        document.querySelector(".temp").innerHTML = Math.round(data.current.temp_c) + "째C";
        document.querySelector(".feel").innerHTML = "Feels Like " + Math.round(data.current.feelslike_c) + "째C";
        document.querySelector(".condition").innerHTML = data.current.condition.text;
        document.querySelector(".humidity").innerHTML = data.current.humidity + "%";
        document.querySelector(".wind").innerHTML = data.current.wind_kph + " km/h";
        document.querySelector(".sunrise").innerHTML = data.forecast.forecastday[0].astro.sunrise.replace(/^0+/,""); /*Remove begining 0's with replace(regex)*/
        document.querySelector(".sunset").innerHTML = data.forecast.forecastday[0].astro.sunset.replace(/^0+/,""); /*Remove begining 0's with replace(regex)*/
    }

    /*For hourly weather need to take the current time in that location, start at the next integer
    Or show the entire 24 hours and highlight the one youe currently on
    Steps
    1. Request forcast for 3 days (most allowed for free version)
    2. Get hourly for 24 hours
    3. disaply each hour in its own block i guess use flex

    later get current time for that area




    */

    /*Event listener for clicking search button*/
    searchBtn.addEventListener("click", ()=>{
        checkWeather(searchBox.value);
    })

    /*Event listener for pressing the enter key*/
    searchBox.addEventListener("keypress", ()=>{
        if(event.key === "Enter"){
            checkWeather(searchBox.value);
        }
    })



    
</script>

    
</body>
</html>